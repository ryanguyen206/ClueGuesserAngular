{"ast":null,"code":"import { NgZone } from '@angular/core';\nimport { User } from '../user';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../global-data.service\";\nimport * as i3 from \"@angular/common/http\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction LoginComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"a\", 8);\n    i0.ɵɵtext(2, \"Homepage\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(3, \"br\")(4, \"br\")(5, \"br\")(6, \"br\");\n    i0.ɵɵelementStart(7, \"span\");\n    i0.ɵɵtext(8, \"You are currently logged in\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"br\");\n    i0.ɵɵelementStart(10, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function LoginComponent_div_14_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.logout());\n    });\n    i0.ɵɵtext(11, \"Logout\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"br\")(13, \"br\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction LoginComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"span\");\n    i0.ɵɵtext(2, \"You are currently logged out\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nexport let LoginComponent = /*#__PURE__*/(() => {\n  class LoginComponent {\n    constructor(ngZone, router, dataService, http) {\n      this.ngZone = ngZone;\n      this.router = router;\n      this.dataService = dataService;\n      this.http = http;\n      this.isLoggedIn = false;\n    }\n\n    ngOnInit() {\n      this.dataService.loginStatus$.subscribe(status => {\n        this.isLoggedIn = status;\n      });\n\n      if (sessionStorage.getItem('ID:') == \"x\") {\n        this.isLoggedIn = false;\n        console.log(sessionStorage.getItem('ID:')); // @ts-ignore\n\n        google.accounts.id.initialize({\n          client_id: \"315207043943-lml7kgh8vurfmn2mv13h8ihn0b066bf9.apps.googleusercontent.com\",\n          callback: this.handleCredentialResponse.bind(this),\n          auto_select: false,\n          cancel_on_tap_outside: true\n        }); // @ts-ignore\n\n        google.accounts.id.renderButton( // @ts-ignore\n        document.getElementById(\"google-button\"), {\n          theme: \"outline\",\n          size: \"large\",\n          width: \"100%\"\n        }); // @ts-ignore\n\n        google.accounts.id.prompt(notification => {});\n      } else {\n        this.isLoggedIn = true;\n        this.dataService.setLoginStatus(true);\n      }\n\n      console.log(this.dataService.loginStatus$);\n    }\n\n    handleCredentialResponse(response) {\n      this.googlePacket = this.parseJwt(response.credential);\n      console.log(\"ID: \" + this.googlePacket.sub);\n      console.log('Given Name: ' + this.googlePacket.name);\n      console.log(\"Image URL: \" + this.googlePacket.picture);\n      console.log(\"Email: \" + this.googlePacket.email);\n      sessionStorage.setItem('ID:', this.googlePacket.sub);\n      sessionStorage.setItem('Name:', this.googlePacket.name);\n      sessionStorage.setItem('Picture:', this.googlePacket.picture);\n      sessionStorage.setItem('Email:', this.googlePacket.email);\n      this.dataService.setLoginStatus(true);\n      this.isLoggedIn = true;\n      this.checkUsers();\n      this.navigate();\n    }\n\n    parseJwt(token) {\n      var base64Url = token.split('.')[1];\n      var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n      var jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n      }).join(''));\n      return JSON.parse(jsonPayload);\n    }\n\n    checkUsers() {\n      this.http.get('https://clueguessernodeserver.azurewebsites.net/users').subscribe( // this.http.get<any>('http://localhost:3000/users').subscribe(\n      response => {\n        let isEmailRegistered = false;\n        console.log('USERS GET request successful:', response);\n\n        for (let i = 0; i < response.length; i++) {\n          if (response[i].email == sessionStorage.getItem(\"Email:\")) {\n            isEmailRegistered = true;\n          }\n        }\n\n        if (isEmailRegistered == false) {\n          let newUser = new User(sessionStorage.getItem(\"Name:\"), sessionStorage.getItem(\"Email:\"));\n          this.http.post('https://clueguessernodeserver.azurewebsites.net/users', newUser) // this.http.post<any>('http://localhost:3000/users', newUser)\n          .subscribe(response => {\n            // Handle the response from the server here\n            console.log('POST USER request successful:', response);\n          }, error => {\n            // Handle any errors here\n            console.error('POST USER request error:', error);\n          });\n        }\n      }, error => {\n        console.error('USERS GET request error:', error);\n      });\n    }\n\n    logout() {\n      sessionStorage.setItem('ID:', \"x\");\n      sessionStorage.setItem('Name:', \"\");\n      sessionStorage.setItem('Picture:', \"\");\n      this.isLoggedIn = false;\n      this.dataService.setLoginStatus(false);\n      this.ngOnInit();\n    }\n\n    navigate() {\n      this.ngZone.run(() => {\n        // Perform navigation or state changes here\n        this.router.navigate(['/tutorial']);\n      });\n    }\n\n  }\n\n  LoginComponent.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.GlobalDataService), i0.ɵɵdirectiveInject(i3.HttpClient));\n  };\n\n  LoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    decls: 16,\n    vars: 2,\n    consts: [[1, \"container\"], [1, \"welcomeText\"], [\"src\", \"https://cdn.discordapp.com/attachments/871488924328022040/1176026840842903612/spy_image.png?ex=656d5f58&is=655aea58&hm=c2a92e61caa6ea6de40a766cd7410c02671e4e044d7d85f51806200f5fe0c52d&\", 1, \"agentLeft\"], [\"src\", \"https://cdn.discordapp.com/attachments/871488924328022040/1176027074054602832/spy_image_rotated.png?ex=656d5f8f&is=655aea8f&hm=3c72d009aa9fd56bb6ff7b3c6561edb122bbcd1b7e0cc4bfc03f77ea4ebb4e8f&\", 1, \"agentRight\"], [1, \"box\"], [\"id\", \"google-button\", 1, \"google-button\"], [\"id\", \"loginstatus\", 4, \"ngIf\"], [\"id\", \"loginstatus\"], [\"id\", \"tutorialLink\", \"routerLink\", \"/tutorial\"], [\"type\", \"button\", \"id\", \"logoutButton\", 1, \"btn\", \"btn-primary\", 3, \"click\"]],\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"head\");\n        i0.ɵɵelementStart(1, \"body\");\n        i0.ɵɵelement(2, \"br\")(3, \"br\");\n        i0.ɵɵelementStart(4, \"div\", 0)(5, \"p\", 1);\n        i0.ɵɵtext(6, \"Welcome to Clue Guesser\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"img\", 2)(8, \"img\", 3);\n        i0.ɵɵelementStart(9, \"div\", 4)(10, \"form\")(11, \"h1\");\n        i0.ɵɵtext(12, \"Sign in\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"div\", 5);\n        i0.ɵɵtemplate(14, LoginComponent_div_14_Template, 14, 0, \"div\", 6);\n        i0.ɵɵtemplate(15, LoginComponent_div_15_Template, 3, 0, \"div\", 6);\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(14);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn == true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn == false);\n      }\n    },\n    dependencies: [i4.NgIf, i1.RouterLinkWithHref, i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.NgForm],\n    styles: [\"*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-image:url(https://i.pinimg.com/originals/fd/77/d1/fd77d12ff2412d1e9523e416c8406bb9.jpg);background-size:cover;margin:0}.welcomeText[_ngcontent-%COMP%]{margin-bottom:200px;font-size:75px}.agentLeft[_ngcontent-%COMP%], .agentRight[_ngcontent-%COMP%]{position:absolute;top:35%;height:300px;width:auto}.agentLeft[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);animation:agentLeftAnimation 1s ease-in-out forwards}.agentRight[_ngcontent-%COMP%]{right:50%;transform:translate(50%);animation:agentRightAnimation 1s ease-in-out forwards}@keyframes agentLeftAnimation{0%{opacity:0;transform:translate(-50%)}to{opacity:1;transform:translate(-200%)}}@keyframes agentRightAnimation{0%{opacity:0;transform:translate(50%)}to{opacity:1;transform:translate(200%)}}.box[_ngcontent-%COMP%]{position:relative;width:380px;height:420px;background:#1c1c1c;border-radius:8px;overflow:hidden;margin:auto;display:flex;flex-direction:column;justify-content:center;transform:translateY(-100px)}.box[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;top:-50%;left:-50%;width:380px;height:420px;background:linear-gradient(0deg,transparent,transparent,skyblue,skyblue,skyblue);z-index:1;transform-origin:bottom right;animation:animate 6s linear infinite}.box[_ngcontent-%COMP%]:after{content:\\\"\\\";position:absolute;top:-50%;left:-50%;width:380px;height:420px;background:linear-gradient(0deg,transparent,transparent,skyblue,skyblue,skyblue);z-index:1;transform-origin:bottom right;animation:animate 6s linear infinite;animation-delay:-3s}@keyframes animate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.box[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{position:absolute;inset:4px;background:#222;padding:50px 40px;border-radius:8px;z-index:2;display:flex;flex-direction:column;width:100%;width:calc(100% - 8px)}.box[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;text-align:center}#google-button[_ngcontent-%COMP%]{align-items:center;justify-content:center;margin:auto}.google-button[_ngcontent-%COMP%]{border-radius:25px}#loginstatus[_ngcontent-%COMP%], #tutorialLink[_ngcontent-%COMP%]{align-items:center;justify-content:center;margin:auto}#logoutButton[_ngcontent-%COMP%]{color:#000;align-items:center;justify-content:center;margin:right;height:25px;width:100px}\"]\n  });\n  return LoginComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}